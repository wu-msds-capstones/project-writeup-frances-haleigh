<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-08-03">

<title>Preventative Care in the United States</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="floating">

<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Preventative Care in the United States</h1>
            <p class="subtitle lead">How do preventative healthcare measures impact standard health metrics?</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>Frances Romero </p>
               <p>Haleigh Schwartz </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 3, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#data-ingestion" id="toc-data-ingestion" class="nav-link" data-scroll-target="#data-ingestion">Data Ingestion</a>
  <ul class="collapse">
  <li><a href="#kff-collection-and-cleaning" id="toc-kff-collection-and-cleaning" class="nav-link" data-scroll-target="#kff-collection-and-cleaning">KFF: Collection and Cleaning</a></li>
  <li><a href="#chrr-collection-and-cleaning" id="toc-chrr-collection-and-cleaning" class="nav-link" data-scroll-target="#chrr-collection-and-cleaning">CHRR: Collection and Cleaning</a></li>
  </ul></li>
  <li><a href="#data-organization" id="toc-data-organization" class="nav-link" data-scroll-target="#data-organization">Data Organization</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a>
  <ul class="collapse">
  <li><a href="#statistical-thinking" id="toc-statistical-thinking" class="nav-link" data-scroll-target="#statistical-thinking">Statistical Thinking</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization">Data Visualization</a></li>
  <li><a href="#data-engineering" id="toc-data-engineering" class="nav-link" data-scroll-target="#data-engineering">Data Engineering</a></li>
  <li><a href="#machine-learning" id="toc-machine-learning" class="nav-link" data-scroll-target="#machine-learning">Machine Learning</a></li>
  <li><a href="#data-ethics" id="toc-data-ethics" class="nav-link" data-scroll-target="#data-ethics">Data Ethics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#introduction-1" id="toc-introduction-1" class="nav-link" data-scroll-target="#introduction-1">Introduction</a></li>
  <li><a href="#analyzing-impact-of-access-to-care-on-health-metrics" id="toc-analyzing-impact-of-access-to-care-on-health-metrics" class="nav-link" data-scroll-target="#analyzing-impact-of-access-to-care-on-health-metrics">Analyzing Impact of Access to Care on Health Metrics</a>
  <ul class="collapse">
  <li><a href="#life-expectancy" id="toc-life-expectancy" class="nav-link" data-scroll-target="#life-expectancy">Life Expectancy</a></li>
  <li><a href="#infant-mortality" id="toc-infant-mortality" class="nav-link" data-scroll-target="#infant-mortality">Infant Mortality</a></li>
  <li><a href="#age-adjusted-death-rate" id="toc-age-adjusted-death-rate" class="nav-link" data-scroll-target="#age-adjusted-death-rate">Age Adjusted Death Rate</a></li>
  </ul></li>
  <li><a href="#predicting-chronic-conditions-based-on-medicaid-data" id="toc-predicting-chronic-conditions-based-on-medicaid-data" class="nav-link" data-scroll-target="#predicting-chronic-conditions-based-on-medicaid-data">Predicting Chronic Conditions Based On Medicaid Data</a>
  <ul class="collapse">
  <li><a href="#diabetes" id="toc-diabetes" class="nav-link" data-scroll-target="#diabetes">Diabetes</a></li>
  <li><a href="#cardiovascular-disease-cvd" id="toc-cardiovascular-disease-cvd" class="nav-link" data-scroll-target="#cardiovascular-disease-cvd">Cardiovascular Disease (CVD)</a></li>
  </ul></li>
  <li><a href="#creating-an-overall-health-quality-variable" id="toc-creating-an-overall-health-quality-variable" class="nav-link" data-scroll-target="#creating-an-overall-health-quality-variable">Creating an Overall Health Quality Variable</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#supplemental-data" id="toc-supplemental-data" class="nav-link" data-scroll-target="#supplemental-data">Supplemental Data</a>
  <ul class="collapse">
  <li><a href="#supplemental-tables" id="toc-supplemental-tables" class="nav-link" data-scroll-target="#supplemental-tables">Supplemental Tables</a>
  <ul class="collapse">
  <li><a href="#s.table-1a-csv-containing-all-variables-used-to-assess-access-to-care" id="toc-s.table-1a-csv-containing-all-variables-used-to-assess-access-to-care" class="nav-link" data-scroll-target="#s.table-1a-csv-containing-all-variables-used-to-assess-access-to-care">S.Table 1A: CSV containing all variables used to assess access to care</a></li>
  <li><a href="#s.table-1b-csv-containing-all-variables-used-to-assess-weight-contribution-to-new-variable" id="toc-s.table-1b-csv-containing-all-variables-used-to-assess-weight-contribution-to-new-variable" class="nav-link" data-scroll-target="#s.table-1b-csv-containing-all-variables-used-to-assess-weight-contribution-to-new-variable">S.Table 1B: CSV containing all variables used to assess weight contribution to new variable</a></li>
  </ul></li>
  <li><a href="#supplemental-figures" id="toc-supplemental-figures" class="nav-link" data-scroll-target="#supplemental-figures">Supplemental Figures</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>To answer questions regarding the effectiveness of preventative care, we investigated current relationships between health care, access to care, public health insurance, and overall health outcomes across the United States. To do so, we took a multi-layered approach to our data:</p>
<ol type="1">
<li>Compare how access to care impacts common health metrics such as life expectancy, mortality, and infant mortality.³</li>
<li>Investigate predictability of chronic condition prevalence between public and private insurances.</li>
<li>Engineer a variable that encapsulates all health metrics to discover what factors are most important to health overall.</li>
</ol>
<p>By examining these questions, we aimed to contribute to the understanding of how preventative care can improve public health in the United States.</p>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>In the world today, there is a growing problem of increasingly poor health across the globe. While life expectancy has increased, the amount of years spent in poor health has also increased proportionally.¹ Within the United States in particular, recent reseach has revealed not only that “the U.S. [has] the lowest life expectancy among high-income countries, but it also has the highest rates of avoidable deaths” despite spending almost 18% of its Gross Domestic Product (GDP) on healthcare. In comparison, the second-highest spender on healthcare is Germany at 12.8%. Furthermore, the United States has almost double the obesity rate than other high-income countries and its citizens are more likely to suffer with multiple chronic conditions.⁵ It is no question that finding a solution to this health endemic is vital to Americans’ health- but what is the answer?</p>
<p>Other research has already attempted to answer this question and found that:</p>
<blockquote class="blockquote">
<p>[a]lthough spending did not correlate meaningfully with health, certain features of the [United States’] health care system did correlate highly with health outcomes, notably rates of health insurance coverage and access to affordable care (not having to forego care due to cost)… [H]ealth outcomes were better in states with adequate primary care services to manage chronic diseases and prevent hospitalizations for conditions like heart attacks, congestive heart failure, and pneumonia.⁸</p>
</blockquote>
<p>This comes as no surprise; having both insurance to cover the cost of healthcare and accessible care lead to better health outcomes. In particular, preventative care is generally accepted as one of the most important factors in maintaining health.⁶ Daily exercise, access to healthy foods, minimal consumption of alcohol, and access to Primary Care Providers (PCPs) are all important factors for improving and maintaining one’s health.</p>
<p>As for insurance’s impact on health, measuring it becomes tricky in the United States. Surprisingly, the U.S. is the only high-income country to not offer health coverage to all citizens.⁵ Instead, both private and social healthcare co-exist, where social healthcare is not available to everyone. Social healthcare in the US is available to those who are disabled or over 65 years old through Medicare. Medicare is not always free, but generally more affordable than private health insurance. Low income Americans can also receive free social healthcare through Medicaid. Social healthcare is funded through both federal and state health expenditures. In our reseach, we focused on just Medicaid in order to better serve our low-income and traditionally marginalized communities.</p>
<p>At the global level, there is a direct link between health insurance type and the health quality of individuals, where countries with universal public health insurance are healthier.⁴ However, within just the United States, there is no correlation between Medicaid spending and disease rate.⁸ We intend to investigate this relationship by discovering chronic disease trends by insurance type. Since we can expect access to preventative care to be limited for those on public health insurance in the United States and know preventative care improves health outcomes, we hypothesize that reduced access to preventative care and higher rates of chronic conditions will exist together.</p>
<p>We recognize we cannot make a causal claim from this data; we can’t answer the question on if reduced access to care <em>causes</em> increased disease rates. This is due to the fact that having low income may just as likely result in a cycle between decreased access to care <em>and</em> higher disease rates. Instead of attempting to find the causal agent in this cycle, we instead aim to provide knowledge and resources for those who have found themselves in such a situation.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<section id="data-ingestion" class="level2">
<h2 class="anchored" data-anchor-id="data-ingestion">Data Ingestion</h2>
<p>We gathered data from two sources: KFF (an independent source for health policy research, polling, and news)⁷ and County Health Rankings and Roadmaps (CHRR).² Though we collected data across several years, we analyzed only data from 2022 due to data quality concerns when comparing year to year.</p>
<section id="kff-collection-and-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="kff-collection-and-cleaning">KFF: Collection and Cleaning</h3>
<p>We generated a custom report from data available on KFF, downloading a large variety of data from 2017-2022 (not including 2020 due to lack of data collection) for each state in the U.S. Variables we investigated from this dataset included percentage of population on Medicare, percentage of adults who smoke, healthcare expenditure, median annual household income, cervical cancer incidence rate, and many more potentially relevant factors.⁷</p>
<p>KFF data for each state was downloaded as CSVs. We chose the most recent dates for all of the different health and insurance related questions between 2017-2022. The CSVs originally had a question, state, and value field. We used text parsing to create a column called demographic and a column called group. This allowed us to parse out demographics like age, race/ethnicity, poverty level and create groups within each of those.</p>
<p>We also created fields called <code>year</code> and <code>measure</code>, and parsed out the years and measurements from the question field. Some questions had multiple demographics, so we created a <code>secondary_demographic</code> field and a <code>secondary_group</code> field. These are not ranked.</p>
<p>Finally, we added a <code>county</code> column (which we filled with all NA) and edited the <code>state</code> and <code>question</code> fields to replicate the way that data from our CHFF dataset was formatted. This allowed us to merge the two datasets.</p>
</section>
<section id="chrr-collection-and-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="chrr-collection-and-cleaning">CHRR: Collection and Cleaning</h3>
<p>Similar to KFF, we downloaded data for each state from 2017-2022 (not including 2020 due to lack of data collection) from County Health Rankings and Roadmaps (CHRR). We chose the “20xx County Health Release National Data” links for each year. Data from CHRR originally came in two separate CSVs for each year and broke up the data by each county in the United States. This data included metrics such as <code>life_expectancy</code>, <code>age-adjusted_death_rate</code>, <code>years_of_potential_life_loss_rate</code>, <code>food_environment_index</code>, <code>percentage_of_physically_inactive_adults</code>, <code>percentage_of_excessive_drinking</code>, <code>Primary_Care_Provider_ratio</code>, and much more.²</p>
<p>First, we cleaned up the columns. We reviewed the documentation and renamed any potentially confusing column names. For example, <code>#_Medicaid_Enrollees</code> became <code>no_female_medicaid_enrollees</code> to avoid mistakenly believing the first column included both genders in its count. We dropped columns that would not be of help to us, such as columns containing the word <code>Unreliable.</code> We replaced all spaces with an underscore.</p>
<p>Second, we joined the two CSVs for each year to have one CSV per year and added a <code>Year</code> column to help with merging later.</p>
<p>Finally, we reformatted the CSVs to match that of the KFF data, where our original columns became the <code>question</code> column and the values filled in a new <code>values</code> column. Again, we used text parsing such as <code>grepl</code> and <code>gsub</code> to fill in our newly created <code>demographic</code>, <code>measure</code>, <code>group</code>, <code>secondary_demographic</code>, and <code>secondary_group</code>, columns. For example, if our question was <code>mean_%_Children_in_Poverty_(white)</code>, our <code>demographic</code>, <code>group</code>, <code>secondary_demographic</code>, and <code>secondary_group</code> columns became “Race/Ethnicity”, “White”, “Age”, and “0-17”, respectively.</p>
<p>Since the questions and potential answers collected by CHRR data varied each year, we made sure that our cleaning code was modified for each year to both accommodate the changes in the data and match identical answers from previous years. As an example, the only races that were listed as options in the 2017 data were “White”, “Black”, “Hispanic”, and “Asian”. However, by the 2022 data collection, the options had expanded to include “American Indian/Alaskan Native”, “Native Hawaiian/Other Pacific Islander”, and “Other/Multiple Races.” In 2022, “Black” was changed to “African American,” so we changed it back to “Black” to both match the earlier CHRR data and the KFF data.</p>
</section>
</section>
<section id="data-organization" class="level2">
<h2 class="anchored" data-anchor-id="data-organization">Data Organization</h2>
<p>Data was combined and normalized to third normal form. The ids were primary keys for each table except for <code>question_responses</code>, where <code>state_id</code>, <code>year_id</code>, and <code>question_id</code> were used as a compound primary key. We used the same foreign key for <code>group</code> and <code>secondary_group</code> and another separate foreign key for both <code>type</code> and <code>secondary_type</code>. All columns had a <code>NOT NULL</code> constraint except for <code>unit_type</code> from the <code>unit</code> table, and <code>unit_id</code>, <code>secondary_group_id</code>, and <code>secondary_type_id</code> from <code>question_responses</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./capstone_erd.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="ERD."><img src="./capstone_erd.png" class="img-fluid figure-img" alt="ERD."></a></p>
<figcaption>ERD.</figcaption>
</figure>
</div>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">Data Analysis</h2>
<section id="statistical-thinking" class="level3">
<h3 class="anchored" data-anchor-id="statistical-thinking">Statistical Thinking</h3>
<p>We determined health status using commonly used proxies such as life expectancy and mortality rates.³ We used statistics (log rank tests) and modeling (Kaplan-Meier curves and linear regression) to determine how access to preventative care correlates with health status. We compared proportions across states to account for differences in population.</p>
<p>In our linear models created in R, we first took the natural logarithm of income-related data due to both its skewed distribution and disproportionate scale (in comparison to the rest of our data).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are these statistical tests?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Test</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Kaplan-Meier Curve</em></td>
<td>A Kaplan-Meier (KM) curve is a display of survival data over time and across groups.</td>
</tr>
<tr class="even">
<td><em>Log Rank Test</em></td>
<td>A log rank test is used to determine if the groups in a KM curve are significant.</td>
</tr>
<tr class="odd">
<td><em>Linear Regression</em></td>
<td>Linear regression is a statistical test used to find and quanitfy linear trends between data.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="data-visualization">Data Visualization</h3>
<p>We used data visualization as part of both our exploratory data analysis and in our final outcome. We created maps of the United States to determine if there is a spatial relationship between our variables and quality of health. Various other visualizations were displayed from our statistical analysis and machine learning product, such as Kaplan-Meier curves, graphs of K-Best’s top features, confusion matrices, and K-Means and/or Gaussian Mixture Model scatterplots, where appropriate.</p>
</section>
<section id="data-engineering" class="level3">
<h3 class="anchored" data-anchor-id="data-engineering">Data Engineering</h3>
<p>We stored our data into a relational database and accessed it with Postgresql (through Railway). We accessed our data in both R and Python using the RPostgreSQL and sqlalchemy libraries, respectively. A detailed description for how this was done is in the data section above.</p>
</section>
<section id="machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="machine-learning">Machine Learning</h3>
<p>We used machine learning models such as ensembles, logistic regression, random forest, naive bayes, PCA, KMeans, Gaussian Mixture Models, and more to explore relationships and predict health outcomes from our data. For example, we predicted metrics like life expectancy based on our access to care variables. We also predicted the prevalence of common chronic conditions, such as Diabetes, within each state based on the percentage of people on Medicaid. Finally, we created a new variable that represented overall health quality.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are these models?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="model-optimization" class="level3">
<h3 class="anchored" data-anchor-id="model-optimization">Model Optimization</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Name</strong></th>
<th><strong>Explaination</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>K-Best Feature Selection</em></td>
<td>K-Best feature selection is a tool used in machine learning used to find which variables in a given model most contribute to its prediction accuracy.</td>
</tr>
<tr class="even">
<td><em>Confusion Matrices</em></td>
<td>Confusion matrices are plots of the true and predicted values of a given model and are used to determine where a model is succeeding and/or failing.</td>
</tr>
</tbody>
</table>
</section>
<section id="supervised-classification-models" class="level3">
<h3 class="anchored" data-anchor-id="supervised-classification-models">Supervised Classification Models</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Name</strong></th>
<th><strong>Explaination</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Random Forests</em></td>
<td></td>
</tr>
<tr class="even">
<td><em>Naive Bayes</em></td>
<td></td>
</tr>
<tr class="odd">
<td><em>Logistic Regression</em></td>
<td></td>
</tr>
<tr class="even">
<td><em>Ensemble</em></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="unsupervised-dimension-reduction-model" class="level3">
<h3 class="anchored" data-anchor-id="unsupervised-dimension-reduction-model">Unsupervised Dimension Reduction Model</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Name</strong></th>
<th><strong>Explaination</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>PCA</em></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="unsupervised-clustering-models" class="level3">
<h3 class="anchored" data-anchor-id="unsupervised-clustering-models">Unsupervised Clustering Models</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Name</strong></th>
<th><strong>Explaination</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>K-Means</em></td>
<td></td>
</tr>
<tr class="even">
<td><em>Gaussian Mixture Model</em></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</div>
</div>
</div>
<section id="process-outlines" class="level4">
<h4 class="anchored" data-anchor-id="process-outlines">Process outlines:</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Goal 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Goal 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Goal 3</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Predicting health by access to care</strong></p>
<ol start="3" type="1">
<li><p>Use KMeans to find the top 10 features from each model . Combine these variables with significant variables from the linear regression models completed in R.</p></li>
<li><p>Create our desired dataframe by reading in data from our remote database and joining where necessary.</p></li>
<li><p>Preprocess:</p>
<ol type="i">
<li>Drop NAs while optimizing data frame size via trial and error.</li>
<li>Use StandardScaler and OneHotEncoder tools from sklearn to transform our numeric and categorical data, respectively.</li>
</ol></li>
<li><p>Use KMeans to find the top 10 features from each model (see <a href="_08_supplemental.qmd#supplemental-figures" title="![Figure 1A](./Figures/kbest_life_exp_1A.png) ![Figure 1B](./Figures/kbest_life_exp_1B.png) ![Figure 1C](./Figures/kbest_life_exp_1C.png)">Supplemental Figures 1A-C</a>). (see <a href="_08_supplemental.qmd#supplemental-figures">Supplemental Figures 1A-C</a>). Combine these variables with significant variables from the linear regression models completed in R.</p></li>
<li><p>Continue preprocessing with the reduced dataset (using only variables from step 3)</p>
<ol type="i">
<li>Bin and modify data as necessary. This ensured equal representation across classes for each predicted y variable. A. In order to use classification tools such as RandomForestClassifier or GradientBoostingClassifier, we binned all our data by quartiles before running it through our models. B. For life expectancy, we dropped outliers first (ages below 60 and above 90, see Supplemental Figure 1D).</li>
<li>Train/test split dataset</li>
</ol></li>
<li><p>Create model</p>
<ol type="i">
<li>Use LogisticRegression, RandomForestClassifier, GradientBoostingClassifier, CategoricalNaiveBayes, and Ensemble. Find which model performs the best.</li>
<li>Hyperparameterize the model that works best from step 5a.</li>
<li>Cross validate finalized model</li>
<li>Test on testing data to find true accuracy</li>
<li>Confusion matrix to see what went wrong (see Supplemental Figures 1E and 1F).</li>
</ol></li>
<li><p>Add PCA to the model</p>
<ol type="i">
<li>Determine how many components explain 90% variance in the model (see Supplemental Figures 1G-1I).</li>
<li>Add PCA with that number of components to the optimized pipeline made from Step 5.</li>
</ol></li>
</ol>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Predicting disease prevalence by insurance type</strong></p>
<ol type="1">
<li>Manipulate data to find mean prevalence of the disease by state. Use this state-wide data rather than the county data as the Medicaid covariates were only available by state.</li>
<li>Preprocess, split, and model the data as outlined in the first process.</li>
</ol>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Engineering overall health variable</strong></p>
<ol type="1">
<li>Gather our entire dataset (not just access to care related variables) See Supplemental Table 1B for a list of all variables used.</li>
<li>Preprocess the dataset using StandardScaler and OneHotEncoder to the appropriate columns.</li>
<li>Use PCA to see how much variance can be explained by the first eigenvalue (see Supplemental Figure 1J).</li>
<li>Project desired health variables to the first eigenvalue.</li>
<li>Compare weights of all variables to see how much they each contribute to this “new variable.”</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="data-ethics" class="level3">
<h3 class="anchored" data-anchor-id="data-ethics">Data Ethics</h3>
<p>We were wary of furthering the gap between classes, races, and/or genders. Often, those in lower socioeconomic status tend to have lower quality of health and less access to affordable healthcare. Our goal was not to perpetuate this gap but to find potential solutions for these underserved populations. We also recognized that our datasets were incomplete and that we were not be able to represent everyone’s needs. Those who are not using well-known forms of insurance, such as Direct Primary Care, or who are not seeking traditional medical care are not represented.</p>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="introduction-1" class="level2">
<h2 class="anchored" data-anchor-id="introduction-1">Introduction</h2>
<p>In order to evaluate the health status of a group of people, we turned to three common metrics for doing so: life expectancy, mortality, and infant mortality.³ In the following sections, we modeled each of these by a list of variables representing access to care (Supplemental Table 1A). Our goal was to determine how access to care influenced each of these three metrics for determining health of a population.</p>
</section>
<section id="analyzing-impact-of-access-to-care-on-health-metrics" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-impact-of-access-to-care-on-health-metrics">Analyzing Impact of Access to Care on Health Metrics</h2>
<section id="life-expectancy" class="level3">
<h3 class="anchored" data-anchor-id="life-expectancy">Life Expectancy</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/life_expectancy_by_state.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Fig 2A: Median Life Expectancy by State."><img src="./images/life_expectancy_by_state.png" class="img-fluid figure-img" alt="Fig 2A: Median Life Expectancy by State."></a></p>
<figcaption>Fig 2A: Median Life Expectancy by State.</figcaption>
</figure>
</div>
<p>Figure 2A demonstrates how median life expectancy varies by state. We decided to keep state in our linear model because it did have a significant correlation with life expectancy. Since not all of the states were significantly correlated, we created the following plot to show which states were significantly correlated (positively or negatively) with life expectancy, as is seen in Figure 2B.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/life_expectancy_significanct_state.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure 2B: Map of State Significance for Life Expectancy."><img src="./images/life_expectancy_significanct_state.png" class="img-fluid figure-img" alt="Figure 2B: Map of State Significance for Life Expectancy."></a></p>
<figcaption>Figure 2B: Map of State Significance for Life Expectancy.</figcaption>
</figure>
</div>
<p>Figure 2C shows our linear model for preventative healthcare measures and life expectancy. We found that Primary Care Physician (PCP) Rate and Ratio were both positively correlated with life expectancy. Percentage of Food Insecurity was negatively correlated with life expectancy (that is, as food insecurity increased, life expectancy decreased). Percentage of Access to Broadband Internet was also positively correlated with life expectancy.</p>
<p>These were all expected, but what was surprising was that the Residential Segregation Index was positively correlated with life expectancy but the opposite relationship was found for the Segregation Index. While we expected to see Segregation Index negatively correlated with life expectancy, it seems to be paradoxical that the opposite was true for the Residential Segregation Index. We realized that our Residential Segregation Index had a lot of missing values, so plotting it against life expectancy didn’t reveal any visible trend. To improve this model in the future, we would remove this predictor.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/life_expectanct_lm_coef.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure 2C: Life Expectancy Linear Model Coefficients."><img src="./images/life_expectanct_lm_coef.png" class="img-fluid figure-img" alt="Figure 2C: Life Expectancy Linear Model Coefficients."></a></p>
<figcaption>Figure 2C: Life Expectancy Linear Model Coefficients.</figcaption>
</figure>
</div>
<p>To better understand the survival (life expectancy) of different groups for each of these variables, we created Kaplan-Meier (KM) Curves where we plotted each variable by quartile. We then conducted a log rank test to compare across quantiles to see if the groups were significantly different from each other. Figure 2D shows life expectancy based on the percentage of food insecurity. Figure 2E shows the results of the log rank test (which are significant as p = &lt;2e-16). Quantiles 1 and 2 (less food insecurity) observed less death than expected, but quantiles 3 and 4 (more food insecurity) observed more death than expected. This demonstrates that we are seeing a significant difference between life expectancy of people in the lower versus the higher quantiles of food insecurity.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/KM_food.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure 2D: Kaplan-Meier Curve for Life Expectancy and Percentage of Food Insecurity."><img src="./images/KM_food.png" class="img-fluid figure-img" alt="Figure 2D: Kaplan-Meier Curve for Life Expectancy and Percentage of Food Insecurity."></a></p>
<figcaption>Figure 2D: Kaplan-Meier Curve for Life Expectancy and Percentage of Food Insecurity.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/log_rank_food.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure 5: Log Rank Test Results for Life Expectancy and Percentage of Food Insecurity."><img src="./images/log_rank_food.png" class="img-fluid figure-img" alt="Figure 5: Log Rank Test Results for Life Expectancy and Percentage of Food Insecurity."></a></p>
<figcaption>Figure 5: Log Rank Test Results for Life Expectancy and Percentage of Food Insecurity.</figcaption>
</figure>
</div>
<p>Kaplan-Meier Curves for life expectancy were made with the following variables: PCP Rate and Ratio, Percentage of Food Insecurity, Segregation Index, and Percentage of Broadband Internet Access. Log rank tests were performed, and all of the results were significant. To explore the curves and log rank test results, please explore our gallery below:</p>
<p>–add a gallery here but ran out of time–</p>
<p>We then used machine learning algorithms to predict life expectancy of individuals based on these significant covariates along with the top ten features found through KBest (see Supplemental Figure 1A). It is important to note that a lot of features were found in both the linear regression model explained above and in the KBest result.</p>
<p>Our model predicted life expectancy based only on the fifteen significant access-to-care-related variables with 56% accuracy. While this may at first appear unimpressive, it’s important to note that 56% of life expectancy can be predicted or explained by only fifteen items- all of which relate to one’s access to healthcare. Only the remaining 44% can be explained by all other factors in a person’s life.</p>
<p>Using the clustering method KMeans, we found the predicted clusters of our life expectancy quartiles projected on its first two principle components (Fig2F). It neatly separates each quartile into four obvious groups. However, we also found that our life expectancy dataset required about twenty-five principle components to explain 90% of the variance in our model (see S.Fig1G), so despite its seemingly accurate divisions, this graphic is limited by its two dimensions. We would need many more to visualize how the data is truly clustering.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/kmeans_life_exp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure 2F: K-means clustering (k=4) for Life Expectancy Model"><img src="./Figures/kmeans_life_exp.png" class="img-fluid figure-img" alt="Figure 2F: K-means clustering (k=4) for Life Expectancy Model"></a></p>
<figcaption>Figure 2F: K-means clustering (k=4) for Life Expectancy Model</figcaption>
</figure>
</div>
</section>
<section id="infant-mortality" class="level3">
<h3 class="anchored" data-anchor-id="infant-mortality">Infant Mortality</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/median_infant_mortality_by_state.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure 3A: Median Infant Mortality Rate by State."><img src="./images/median_infant_mortality_by_state.png" class="img-fluid figure-img" alt="Figure 3A: Median Infant Mortality Rate by State."></a></p>
<figcaption>Figure 3A: Median Infant Mortality Rate by State.</figcaption>
</figure>
</div>
<p>Figure 3A shows a difference between median infant mortality rates between states. Note that the chart appears to “stair-step” as Infant Mortality Rate are represented as integers rather than continuous numbers. Because of the linear trend associated with each state, we included the variable in our linear model to determine which states were significantly correlated with infant mortality.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/significance_state_infant_mortality.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure 3B: Significance of State for Infant Mortality."><img src="./images/significance_state_infant_mortality.png" class="img-fluid figure-img" alt="Figure 3B: Significance of State for Infant Mortality."></a></p>
<figcaption>Figure 3B: Significance of State for Infant Mortality.</figcaption>
</figure>
</div>
<p>Figure 3B shows which states were positively or negatively correlated with infant mortality. Note this map has negative significance in green since that would mean less infant mortality. In this case, Maryland and Mississippi have significantly higher rates of infant mortality.</p>
<p>In terms of preventative healthcare measures that were significantly correlated with infant mortality (Figure 3C), we found that Median Household Income and Broadband Internet Access were significantly correlated in the negative direction with infant mortality. That is, as income and access to the Internet increased, infant mortality rates decreased. We came across the same issue with segregation here as we did in our life expectancy model. The Segregation Index coefficient shows that as segregation increases, infant mortality rates increase as well.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/infant_mortality_lm_coef.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure 3C: Infant Mortality Linear Model Coefficients."><img src="./images/infant_mortality_lm_coef.png" class="img-fluid figure-img" alt="Figure 3C: Infant Mortality Linear Model Coefficients."></a></p>
<figcaption>Figure 3C: Infant Mortality Linear Model Coefficients.</figcaption>
</figure>
</div>
<p>In our machine learning model, we repeated the same process for infant mortality rate as for life expectancy, but got a low accuracy score of 36% due to the high number of NAs in our Infant Mortality Rate column. Future analyses would do well to increase record-keeping of infant mortality rates by county as the metric “indicates the current health status of a population and reflects the overall state of maternal health, as well as the quality and accessibility of primary health care available to pregnant women and infants.”³</p>
</section>
<section id="age-adjusted-death-rate" class="level3">
<h3 class="anchored" data-anchor-id="age-adjusted-death-rate">Age Adjusted Death Rate</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/median_mortality_rate_by_state.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure 4A: Median Mortality Rate by State."><img src="./images/median_mortality_rate_by_state.png" class="img-fluid figure-img" alt="Figure 4A: Median Mortality Rate by State."></a></p>
<figcaption>Figure 4A: Median Mortality Rate by State.</figcaption>
</figure>
</div>
<p>Age-adjusted death rate (mortality rate) appeared to vary across states as seen in Figure 4A, so we again kept state in our linear model. Figure 4B shows which states were significantly correlated with mortality rate. Negative correlation is in green (AZ) showing a significantly lower death rate in Arizona. Positive correlation is in red, showing significantly higher death rates.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/significance_state_death_rate_map.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure 4B: Significance of State for Age Adjusted Death Rate (Mortality Rate)."><img src="./images/significance_state_death_rate_map.png" class="img-fluid figure-img" alt="Figure 4B: Significance of State for Age Adjusted Death Rate (Mortality Rate)."></a></p>
<figcaption>Figure 4B: Significance of State for Age Adjusted Death Rate (Mortality Rate).</figcaption>
</figure>
</div>
<p>Preventative healthcare measures that were significantly correlated with mortality rate are shown in figure 4C. As food insecurity, segregation (excluding residential segregation), and school segregation increased, mortality rates increased as well. As broadband internet access, vaccination, and number of rural residents increased, mortality rates decreased.</p>
<p>Looking at demographics, we noticed as income increased among white Americans, mortality rates decreased. This income trend was the opposite among Asian and Hispanic Americans. Looking closer at the income correlation plots, the trends for Asian and Hispanic Americans appear to have more data points that could be considered outliers. As the percentage of severe housing issues increased, the mortality rate decreased, but the correlation plot appears to have outliers that could be skewing this trend as well.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/death_rate_lm_coef.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure 4C: Age Adjusted Death Rate (Mortality Rate) Linear Model Coefficients."><img src="./images/death_rate_lm_coef.png" class="img-fluid figure-img" alt="Figure 4C: Age Adjusted Death Rate (Mortality Rate) Linear Model Coefficients."></a></p>
<figcaption>Figure 4C: Age Adjusted Death Rate (Mortality Rate) Linear Model Coefficients.</figcaption>
</figure>
</div>
<p>Finally, we repeated our machine learning process to predict age-adjusted death rate based on our significant access to care covariates. Our model accurately predicted the binned death rate for 62% of our test data. Just thirteen access-to-care-related covariates predicted mortality rate 62% of the time! This again emphasizes the importance of access to care in one’s overall health status.</p>
<p>KMeans clustering again found four apparent clusters within our data along its first two principle components. As with the life expectancy data, we found that our data needs 30 components to explain 90% of its variance, so this two dimensional plot is missing a lot of further details that would otherwise be revealed by a multi-dimensional graphic.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/kmeans_mortality.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure 4D: K-means clustering (k=4) for Age-Adjusted Death Rate Model"><img src="./Figures/kmeans_mortality.png" class="img-fluid figure-img" alt="Figure 4D: K-means clustering (k=4) for Age-Adjusted Death Rate Model"></a></p>
<figcaption>Figure 4D: K-means clustering (k=4) for Age-Adjusted Death Rate Model</figcaption>
</figure>
</div>
</section>
</section>
<section id="predicting-chronic-conditions-based-on-medicaid-data" class="level2">
<h2 class="anchored" data-anchor-id="predicting-chronic-conditions-based-on-medicaid-data">Predicting Chronic Conditions Based On Medicaid Data</h2>
<p>To answer the question of how state insurance in particular impacts one’s health status, we evaluated two common chronic conditions in the United States, diabetes and cardiovascular disease.</p>
<section id="diabetes" class="level3">
<h3 class="anchored" data-anchor-id="diabetes">Diabetes</h3>
<p>We immediately plotted our mean diabetes percentages by Medicaid percentage across states to see if any obvious correlation existed (see Fig5B). No correlation was obvious, but there appeared to be a slight linear trend. We created a linear regression model predicting diabetes prevalence by many Medicaid-related covariates, such as how many adults did not see a doctor in the past twelve months due to cost, state Medicaid expenditure, state Medicaid spending, total Medicaid spending, and population percentage on Medicaid. Our simple model showed a surprising 38% accuracy in predicting how many people in a given population would have diabetes based on these factors. While Medicaid-related factors may not be able to completely predict diabetes prevalence, it certainly plays a role.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/dm_medicaid.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure 5A: Mean diabetes percentage per state vs Medicaid percentage"><img src="./Figures/dm_medicaid.png" class="img-fluid figure-img" alt="Figure 5A: Mean diabetes percentage per state vs Medicaid percentage"></a></p>
<figcaption>Figure 5A: Mean diabetes percentage per state vs Medicaid percentage</figcaption>
</figure>
</div>
</section>
<section id="cardiovascular-disease-cvd" class="level3">
<h3 class="anchored" data-anchor-id="cardiovascular-disease-cvd">Cardiovascular Disease (CVD)</h3>
<p>As with our diabetes dataset, we again repeated the above process to predict CVD prevalence based on Medicaid-only related factors. Our simple scatterplot shows a faint linear trend and two potential clusters. Shockingly, our model accurately predicted CVD prevalence 46% of the time! This is such a high number that it cannot be ignored, and we can assume Medicaid plays some factor in a population’s cardiovascular disease prevalence.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/cvd_medicaid.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure 5B: Mean CVD Percentage per State vs Medicaid Percentage"><img src="./Figures/cvd_medicaid.png" class="img-fluid figure-img" alt="Figure 5B: Mean CVD Percentage per State vs Medicaid Percentage"></a></p>
<figcaption>Figure 5B: Mean CVD Percentage per State vs Medicaid Percentage</figcaption>
</figure>
</div>
</section>
</section>
<section id="creating-an-overall-health-quality-variable" class="level2">
<h2 class="anchored" data-anchor-id="creating-an-overall-health-quality-variable">Creating an Overall Health Quality Variable</h2>
<p>As a final metric for assessing quality of health, we wanted to create a new variable that represented the overall health of a population. We knew that the following variables should be included in the creation of this new variable: Life Expectancy, Age-Adjusted Death Rate, Years of Potential Life Lost Rate, Percent of Frequent Physical Distress Days, and Percent of Frequent Mental Distress Days. We chose the first three for the same reasons explained in the introduction to our results.3 Note that we left out Infant Mortality Rate due to its high number of NAs, as explained above. We added the final two metrics to account for a person’s perceived quality of life, which does influence’s one’s actual health quality. A clear linear relationship is seen between each of these metrics in the pair plot below (Fig 6A).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/pairplot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure 6A: Health Metrics Pair Plot"><img src="./Figures/pairplot.png" class="img-fluid figure-img" alt="Figure 6A: Health Metrics Pair Plot"></a></p>
<figcaption>Figure 6A: Health Metrics Pair Plot</figcaption>
</figure>
</div>
<p>Though the first eigenvalue of our entire dataset only explained 31% of the variance in our dataset, we continued by projecting the variables above to this first eigenvalue, thus “creating” a new variable that represents overall health. We then plotted the weights of all of our other variables against this new one to see how much each contributed to overall health. 87 of our original features contributed negatively to this new variable and 35 positively. Fig6B shows which features contribute the most in both a positive and negative direction to health.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/weights.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure 6B: Top 5 High and Bottom 5 Low Weights"><img src="./Figures/weights.png" class="img-fluid figure-img" alt="Figure 6B: Top 5 High and Bottom 5 Low Weights"></a></p>
<figcaption>Figure 6B: Top 5 High and Bottom 5 Low Weights</figcaption>
</figure>
</div>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>Our analysis showed significant correlations between various socio-economic factors and key health outcomes such as life expectancy, infant mortality, and age-adjusted death rate. Specifically, food insecurity, broadband internet access, and segregation emerged as crucial features. While we observed meaningful correlations, certain findings were limited by missing data, particularly regarding residential segregation and infant mortality rate, which should be excluded from future models made from the same data.</p>
<p>Adjustments for outliers are necessary to better understand the nuanced relationship between income and death rates within our linear models. Importantly, the prevalence of primary care physicians correlated positively with life expectancy, reinforcing the expected relationship between access to healthcare and improved health outcomes.</p>
<p>Furthermore, our additional findings highlight the impact of preventative healthcare measures on overall health. For instance, broadband internet access and median household income showed significant negative correlations with infant mortality, indicating that better access to resources and economic stability can contribute to lower infant mortality rates. Conversely, higher segregation indices were associated with increased infant mortality, emphasizing the detrimental effects of social and economic divides.</p>
<p>Our predictive models, though varying in accuracy, consistently underscored the importance of healthcare access. The life expectancy and age-adjusted death rate models based on access-to-care variables suggested that a significant portion of health outcomes can be anticipated through healthcare accessibility metrics.</p>
<p>Furthermore, our findings related to Diabetes (DM) and Cardiovascular Disease (CVD) reveal significant insights into the impact of Medicaid on chronic conditions. Our linear regression models demonstrated that Medicaid-related factors could predict diabetes prevalence with 38% accuracy and cardiovascular disease prevalence with 46% accuracy. These findings highlight the substantial role Medicaid plays in managing these chronic conditions and underscore the importance of access to healthcare for lower-income populations.</p>
<p>Overall, our comprehensive analysis confirms the critical role of socio-economic factors, healthcare access, and preventative measures in determining health outcomes. Future research should focus on refining models to account for outliers and improving data completeness to further explore these relationships.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ol type="1">
<li>Broom, D. (2022, April 5). <em>We’re spending more years in poor health than at any point in history. How can we change this?</em> World Economic Forum. https://www.weforum.org/agenda/2022/04/longer-healthier-lives-everyone/#:~:text=Global%20Health,-Follow&amp;text=Life%20expectancy%20is%20rising%2C%20but,six%20years%20of%20quality%20life.</li>
<li>County Health Rankings &amp; Roadmaps. (2024). <em>Data &amp; Documentation.</em> County Health Rankings &amp; Roadmaps. https://www.countyhealthrankings.org/health-data/methodology-and-sources/data-documentation</li>
<li>EPA. (2023, August 10). <em>Health status.</em> EPA. https://www.epa.gov/report-environment/health-status#:~:text=The%20health%20status%20of%20a,accessibility%20of%20health%20personnel%20and</li>
<li>Galvani-Townsend, S., Martinez, I., &amp; Pandey, A. (2022). Is life expectancy higher in countries and territories with publicly funded health care? Global analysis of health care access and the social determinants of health. <em>Journal of Global Health, 12</em>(04091), 1-12. doi: 10.7189/jogh.12.04091</li>
<li>Gunja, M.Z., Gumaz, E.D., &amp; Williams, R.D.II. (2023, Jan.&nbsp;31). <strong>U.S. Health Care from a Global Perspective, 2022: Accelerating Spending, Worsening Outcomes.</strong> The Commonwealth Fund. https://www.commonwealthfund.org/publications/issue-briefs/2023/jan/us-health-care-global-perspective-2022<br>
</li>
<li>Harvard School of Public Health. (2022, December). <em>Healthy longevity.</em> The Nutrition Source. https://nutritionsource.hsph.harvard.edu/healthy-longevity/</li>
<li>KFF. (2024). <em>State Health Facts: Build A Custom State Report</em> KFF: The independent source for health policy research, polling, and news. https://www.kff.org/statedata/custom/</li>
<li>Woolf , S.H., Aron, L., Chapman, D.A., Dubay, L., Zimmerman, E., Snellings, L.C., Hall, L., Haley, A.D., Holla, N., Ayers, K., Lowenstein, C., &amp; Waidmann, T.A. (2016). <em>The health of the States: How U.S. States compare in health status and the factors that shape health.</em> Virginia Commonwealth University Center on Society and Health. https://www.urban.org/sites/default/files/publication/85211/health-of-the-states_6.pdf</li>
</ol>
</section>
<section id="supplemental-data" class="level1">
<h1>Supplemental Data</h1>
<section id="supplemental-tables" class="level2">
<h2 class="anchored" data-anchor-id="supplemental-tables">Supplemental Tables</h2>
<section id="s.table-1a-csv-containing-all-variables-used-to-assess-access-to-care" class="level3">
<h3 class="anchored" data-anchor-id="s.table-1a-csv-containing-all-variables-used-to-assess-access-to-care">S.Table 1A: CSV containing all variables used to assess access to care</h3>
<button id="download-button" class="btn btn-danger">
<i class="fa fa-save"></i> Download S.Table 1A
</button>
<script>
  document.getElementById('download-button').addEventListener('click', function() {
    const csvFilePath = './Figures/access_to_care_total.csv'; // Update the path to your CSV file
    const link = document.createElement('a');
    link.href = csvFilePath;
    link.download = 'access_to_care_total.csv'; // The name of the file to be downloaded
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  });
</script>
</section>
<section id="s.table-1b-csv-containing-all-variables-used-to-assess-weight-contribution-to-new-variable" class="level3">
<h3 class="anchored" data-anchor-id="s.table-1b-csv-containing-all-variables-used-to-assess-weight-contribution-to-new-variable">S.Table 1B: CSV containing all variables used to assess weight contribution to new variable</h3>
<button id="download-button2" class="btn btn-danger">
<i class="fa fa-save"></i> Download S.Table 1B
</button>
<script>
  document.getElementById('download-button2').addEventListener('click', function() {
    const csvFilePath = './Figures/all_columns_list.csv'; // Update the path to your CSV file
    const link = document.createElement('a');
    link.href = csvFilePath;
    link.download = 'all_columns_list.csv'; // The name of the file to be downloaded
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  });
</script>
</section>
</section>
<section id="supplemental-figures" class="level2">
<h2 class="anchored" data-anchor-id="supplemental-figures">Supplemental Figures</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/kbest_life_exp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure S.1A: KBest Features for Life Expectancy"><img src="./Figures/kbest_life_exp.png" class="img-fluid figure-img" alt="Figure S.1A: KBest Features for Life Expectancy"></a></p>
<figcaption>Figure S.1A: KBest Features for Life Expectancy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/kbest_inf_mor.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure S.1B: KBest Features for Infant Mortality Rate"><img src="./Figures/kbest_inf_mor.png" class="img-fluid figure-img" alt="Figure S.1B: KBest Features for Infant Mortality Rate"></a></p>
<figcaption>Figure S.1B: KBest Features for Infant Mortality Rate</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/kbest_mortality.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure S.1C: KBest Features for Death Rate"><img src="./Figures/kbest_mortality.png" class="img-fluid figure-img" alt="Figure S.1C: KBest Features for Death Rate"></a></p>
<figcaption>Figure S.1C: KBest Features for Death Rate</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/life_expectancy_bins.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figure S.1D: Distribution of Life Expectancy Quartiles"><img src="./Figures/life_expectancy_bins.png" class="img-fluid figure-img" alt="Figure S.1D: Distribution of Life Expectancy Quartiles"></a></p>
<figcaption>Figure S.1D: Distribution of Life Expectancy Quartiles</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/conf_matrix_life_exp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Figure S.1E: Confusion Matrix for Life Expectancy Model"><img src="./Figures/conf_matrix_life_exp.png" class="img-fluid figure-img" alt="Figure S.1E: Confusion Matrix for Life Expectancy Model"></a></p>
<figcaption>Figure S.1E: Confusion Matrix for Life Expectancy Model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/conf_matrix_mortality.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="S.Figure S.1F: Confusion Matrix for Death Rate Model"><img src="./Figures/conf_matrix_mortality.png" class="img-fluid figure-img" alt="S.Figure S.1F: Confusion Matrix for Death Rate Model"></a></p>
<figcaption>S.Figure S.1F: Confusion Matrix for Death Rate Model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/variance_life_exp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Figure S.1G: Variance Explained by each Principle Component in the Life Expectancy Model"><img src="./Figures/variance_life_exp.png" class="img-fluid figure-img" alt="Figure S.1G: Variance Explained by each Principle Component in the Life Expectancy Model"></a></p>
<figcaption>Figure S.1G: Variance Explained by each Principle Component in the Life Expectancy Model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/variance_inf_mor.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Figure S.1H: Variance Explained by each Principle Component in the Infant Mortality Model"><img src="./Figures/variance_inf_mor.png" class="img-fluid figure-img" alt="Figure S.1H: Variance Explained by each Principle Component in the Infant Mortality Model"></a></p>
<figcaption>Figure S.1H: Variance Explained by each Principle Component in the Infant Mortality Model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/variance_mortality.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Figure S.1I: Variance Explained by each Principle Component in the Death Rate Model"><img src="./Figures/variance_mortality.png" class="img-fluid figure-img" alt="Figure S.1I: Variance Explained by each Principle Component in the Death Rate Model"></a></p>
<figcaption>Figure S.1I: Variance Explained by each Principle Component in the Death Rate Model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./Figures/total_eigenvalue.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure S.1J: Explained Variance by Eigenvalue for Entire Dataset"><img src="./Figures/total_eigenvalue.png" class="img-fluid figure-img" alt="Figure S.1J: Explained Variance by Eigenvalue for Entire Dataset"></a></p>
<figcaption>Figure S.1J: Explained Variance by Eigenvalue for Entire Dataset</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/wu-msds-capstones\.github\.io\/us_health_quality\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","closeEffect":"zoom","descPosition":"bottom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>